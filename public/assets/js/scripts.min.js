(()=>{var T=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var Q=Object.getOwnPropertyNames;var X=Object.prototype.hasOwnProperty;var Z=(e,o)=>()=>(e&&(o=e(e=0)),o);var d=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports),ee=(e,o)=>{for(var n in o)T(e,n,{get:o[n],enumerable:!0})},te=(e,o,n,s)=>{if(o&&typeof o=="object"||typeof o=="function")for(let a of Q(o))!X.call(e,a)&&a!==n&&T(e,a,{get:()=>o[a],enumerable:!(s=K(o,a))||s.enumerable});return e};var f=e=>te(T({},"__esModule",{value:!0}),e);var m={};ee(m,{toast:()=>ne});function ne(e,o){y||(y=document.createElement("div"),y.classList.add("toastContain"),document.body.appendChild(y));let n=document.createElement("div");n.classList.add("toast",o),n.innerText=e,y.prepend(n),setTimeout(()=>n.classList.add("open"),10),setTimeout(()=>n.classList.remove("open"),3e3),setTimeout(()=>y.removeChild(n),3500)}var y,p=Z(()=>{});var j=d(()=>{var P=(p(),f(m));window.location.pathname==="/account"&&(document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("[data-tab]"),o=document.querySelectorAll("[data-content]");e.forEach(n=>{n.addEventListener("click",()=>{e.forEach(a=>a.classList.remove("border-b-2","border-blue-500","text-mantis-primary")),o.forEach(a=>a.classList.add("hidden")),n.classList.add("border-b-2","border-mantis-primary","text-mantis-primary");let s=n.getAttribute("data-tab");document.querySelector(`[data-content="${s}"]`).classList.remove("hidden")})}),e[0].click()}),document.getElementsByTagName("form")[0].addEventListener("submit",e=>{e.preventDefault(),oe(e)}));var oe=async e=>{e.preventDefault();let o=e.target,n=new FormData(o),s=Object.fromEntries(n);console.log(s);try{(await fetch(`/common/v1/users/${s.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?P("Account updated.","success"):P("Update failed.","error")}catch(a){P("Something went wrong.","error"),console.error(a)}}});var I=d(()=>{document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementsByClassName("dropdown-btn"),o=document.getElementsByClassName("dropdown-menu");for(let n=0;n<e.length;n++)e[n].addEventListener("click",s=>{s.stopPropagation(),o[n].classList.toggle("hidden");let a=e[n].getAttribute("aria-expanded")==="true";e[n].setAttribute("aria-expanded",String(!a))});document.addEventListener("click",()=>{for(let n=0;n<o.length;n++)o[n].classList.contains("hidden")||(o[n].classList.add("hidden"),e[n].setAttribute("aria-expanded","false"))})})});var M=d(()=>{var{toast:q}=(p(),f(m));window.location.pathname==="/newsletter"&&document.addEventListener("DOMContentLoaded",()=>{document.getElementsByTagName("form")[0].addEventListener("submit",e=>{re(e)})});if(window.location.pathname==="/newsletter-confirm"){let e=new URLSearchParams(window.location.search);if(e.get("token")){let o=e.get("token");fetch("/common/v1/newsletter/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o})})}}var re=async e=>{e.preventDefault();let o=document.querySelector("input[name='name']").value,n=document.querySelector("input[name='email']").value,s=document.querySelector("input[name='agreed-to-subscription']").checked;if(!o||!n||!s){q("Please fill out all fields.","error"),document.querySelector("input[name='name']").focus();return}let a={name:o,email:n,agreedToSubscription:s};try{await fetch("/common/v1/newsletter/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(c=>{c.status===409&&q("E-mail is already subscribed.","error"),c.ok?(document.querySelector("input[name='name']").value="",document.querySelector("input[name='email']").value="",document.querySelector("input[name='agreed-to-subscription']").checked=!1,q("Subscribtion successful.","success")):q("Subscribtion failed.","error")})}catch(c){console.log(c)}}});var U=d(()=>{var{toast:E}=(p(),f(m));if(window.location.pathname==="/auth/register"){document.addEventListener("DOMContentLoaded",()=>{document.getElementsByTagName("form")[0].addEventListener("submit",o=>{e(o)})});let e=async o=>{o.preventDefault();let n=document.querySelector("input[name='username']").value,s=document.querySelector("input[name='email']").value,a=document.querySelector("input[name='password']").value,c=document.querySelector("input[name='password-repeat']").value,k=document.querySelector("input[name='agreed-to-terms']").checked;if(!n||!s||!a||!c||!k){E("Please fill out all fields.","error");return}if(a!==c){E("Passwords do not match.","error");return}let g={username:n,email:s,password:a,passwordRepeat:c,agreedToTerms:k};try{let h=await fetch("/common/v1/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),w=await h.json();if(!h.ok){let v=w.message||"An unknown error occurred.";E(v,"error");return}E("Please confirm your e-mail.","success"),document.querySelector("input[name='username']").value="",document.querySelector("input[name='email']").value="",document.querySelector("input[name='password']").value="",document.querySelector("input[name='password-repeat']").value="",document.querySelector("input[name='agreed-to-terms']").checked=!1}catch(h){console.error("Fetch error:",h),E("Network error or unhandled exception.")}}}});var F=d(()=>{var{toast:we}=(p(),f(m));window.location.pathname==="/auth/confirm"&&document.addEventListener("DOMContentLoaded",()=>{se()});async function se(){let e=document.getElementById("message-box");e.classList.remove("hidden"),e.classList.add("border-sky-500","bg-sky-100","text-sky-700"),e.innerHTML="Verifying token...";let o=window.location.search.split("=")[1],n=await fetch("/common/v1/auth/confirm?token="+o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:o})}),s=await n.json();n.ok?(e.classList.remove("border-sky-500","bg-sky-100","text-sky-700"),e.classList.add("border-green-500","bg-green-100","text-green-700"),e.innerHTML=s.message,setTimeout(()=>{window.location.href="/auth/login"},3e3)):(e.classList.remove("hidden"),e.classList.add("border-rose-500","bg-rose-100","text-rose-700"),e.innerHTML=s.message)}});var $=d(()=>{var{toast:C}=(p(),f(m));window.location.pathname==="/auth/login"&&document.addEventListener("DOMContentLoaded",()=>{document.getElementsByTagName("form")[0].addEventListener("submit",e=>{ae(e)})});var ae=async e=>{e.preventDefault();let o=document.querySelector("input[name='email']").value,n=document.querySelector("input[name='password']").value;if(!o||!n){C("Please fill out all fields.","error"),document.querySelector("input[name='email']").focus();return}let s={email:o,password:n};try{let a=await fetch("/common/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),c=await a.json();a.ok?(localStorage.setItem("token",c.token),C("Login successful.","success"),document.querySelector("input[name='email']").value="",document.querySelector("input[name='password']").value="",setTimeout(()=>window.location.href="/",1500)):(C(c.message||"Login failed.","error"),document.querySelector("input[name='email']").focus())}catch(a){console.log(a)}}});var J=d(()=>{(window.location.pathname===localStorage.getItem("token")||window.location.pathname!=="/newsletter"||window.location.pathname!=="/auth/confirm")&&document.addEventListener("DOMContentLoaded",()=>{document.getElementById("logout-btn")&&document.getElementById("logout-btn").addEventListener("click",o=>{o.stopPropagation(),fetch("/common/v1/auth/logout",{method:"POST"}).then(n=>{n.ok&&(window.location.href="/")})})})});var R=d(()=>{var{toast:b}=(p(),f(m));window.location.pathname==="/auth/reset-password"&&document.addEventListener("DOMContentLoaded",()=>{document.getElementsByTagName("form")[0].addEventListener("submit",e=>{ie(e)})});var ie=async e=>{e.preventDefault();let o=e.target,n=document.querySelector("input[name='email']").value;if(!n){b("Please fill out all fields.","error");return}let s={email:n};try{(await fetch("/common/v1/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?(document.querySelector("input[name='email']").value="",b("Password reset email sent.","success")):b("Password reset failed.","error")}catch(a){b("Something went wrong.","error"),console.log(a)}}});var H=d(()=>{var{toast:l}=(p(),f(m)),B=!1,O=null;document.addEventListener("DOMContentLoaded",()=>{if(window.location.pathname!=="/links")return;let e=document.getElementById("link-form"),o=document.getElementsByClassName("edit-link-btn"),n=document.getElementsByClassName("delete-link-btn"),s=document.getElementById("create-link-btn-text"),a=document.getElementById("update-link-btn-text"),c=document.getElementById("modal");e.addEventListener("submit",t=>{t.preventDefault(),B?w():g()}),Array.from(o).forEach(t=>{t.addEventListener("click",r=>{r.stopPropagation();let i=t.getAttribute("data-link-id");h(i)})}),Array.from(n).forEach(t=>{t.addEventListener("click",r=>{r.stopPropagation();let i=t.getAttribute("data-link-id");v(i)})});function k(){B=!1,O=null,s.classList.remove("hidden"),a.classList.add("hidden")}async function g(){let t=L();if(S(t))try{(await fetch("/common/v1/links",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(l("Link created.","success"),window.location.href="/links"):l("Link creation failed.","error")}catch(r){l("Something went wrong.","error"),console.error(r)}}async function h(t){if(!t){l("Link ID is missing.","error");return}B=!0,O=t,s.classList.add("hidden"),a.classList.remove("hidden"),c.classList.remove("hidden"),c.classList.add("flex");try{let r=await fetch(`/common/v1/links/${t}`),i=await r.json();if(!r.ok){l("Link not found.","error");return}D(i)}catch(r){console.error("Something went wrong:",r),l("Something went wrong.","error")}}async function w(){let t=L();if(t.id=O,!!S(t))try{(await fetch(`/common/v1/links/${t.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(l("Link updated.","success"),window.location.href="/links"):l("Update failed.","error")}catch(r){l("Something went wrong.","error"),console.error(r)}}async function v(t){try{(await fetch(`/common/v1/links/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok?(document.querySelector(`#link-${t}`).remove(),l("Link deleted.","success")):l("Deletion failed.","error")}catch(r){l("Something went wrong.","error"),console.error(r)}}function L(){return{title:document.querySelector("input[name='title']").value.trim(),url:document.querySelector("input[name='url']").value.trim(),description:document.querySelector("textarea[name='description']").value.trim(),isPublic:document.querySelector("input[name='is-public']").checked}}function D(t){document.querySelector("input[name='title']").value=t.title||"",document.querySelector("input[name='url']").value=t.url||"",document.querySelector("textarea[name='description']").value=t.description||"",document.querySelector("input[name='is-public']").checked=!!t.isPublic}function S({title:t,url:r,description:i}){return!t||!r||!i?(l("Please fill out all required fields.","error"),!1):!0}})});var _=d(()=>{var{toast:u}=(p(),f(m)),x=!1,A=null;document.addEventListener("DOMContentLoaded",()=>{if(window.location.pathname!=="/posts"&&window.location.pathname!=="/posts/create")return;let e=document.getElementById("post-form"),o=document.getElementsByClassName("edit-post-btn"),n=document.getElementsByClassName("delete-post-btn"),s=document.getElementById("create-post-btn-text"),a=document.getElementById("update-post-btn-text"),c=document.getElementById("modal");e.addEventListener("submit",t=>{t.preventDefault(),x?w():g()}),Array.from(o).forEach(t=>{t.addEventListener("click",r=>{r.stopPropagation();let i=t.getAttribute("data-post-id");h(i)})}),Array.from(n).forEach(t=>{t.addEventListener("click",r=>{r.stopPropagation();let i=t.getAttribute("data-post-id");v(i)})});function k(){x=!1,A=null,s.classList.remove("hidden"),a.classList.add("hidden")}async function g(){let t=L();if(S(t))try{(await fetch("/common/v1/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok?(u("Post created.","success"),setTimeout(()=>{window.location.href="/posts"},1500)):u("Post creation failed.","error")}catch(r){u("Something went wrong.","error"),console.error(r)}}async function h(t){if(!t){u("Post ID is missing.","error");return}x=!0,A=t,s.classList.add("hidden"),a.classList.remove("hidden"),c.classList.remove("hidden"),c.classList.add("flex");try{let r=await fetch(`/common/v1/posts/${t}`),i=await r.json();if(!r.ok){u("Post not found.","error");return}D(i)}catch(r){console.error("Something went wrong:",r),u("Something went wrong.","error")}}async function w(){let t=L();if(t.id=A,!!S(t))try{let r=await fetch(`/common/v1/posts/${t.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r.ok)u("Post updated.","success"),window.location.href="/posts";else{let i=await r.json();console.log(i),u("Update failed.","error")}}catch(r){u("Something went wrong.","error"),console.error(r)}}async function v(t){try{if((await fetch(`/common/v1/posts/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok){let i=document.querySelector(`#post-${t}`);i.classList.add("border-rose-500"),i.remove(),u("Post deleted.","success")}else u("Deletion failed.","error")}catch(r){u("Something went wrong.","error"),console.error(r)}}function L(){return{title:document.querySelector("input[name='title']").value.trim(),description:document.querySelector("textarea[name='description']").value.trim(),slug:document.querySelector("input[name='slug']").value.trim(),content:document.querySelector("textarea[name='content']").value.trim(),status:document.querySelector("select[name='post-status']").value.trim()}}function D(t){document.querySelector("input[name='title']").value=t.title||"",document.querySelector("textarea[name='description']").value=t.description||"",document.querySelector("select[name='post-status']").value=t.status||"",document.querySelector("input[name='slug']").value=t.slug||"",document.querySelector("textarea[name='content']").value=t.content||""}function S({title:t,description:r,content:i,slug:V,status:z}){return!t||!r||!i||!V||!z?(u("Please fill out all required fields.","error"),!1):!0}})});var Y=d(()=>{window.location.pathname==="/dashboard"&&document.addEventListener("DOMContentLoaded",()=>{fetch("/common/v1/links",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{document.querySelector(".link-count").innerHTML=e.length}).catch(e=>{console.error("Error fetching links:",e)})})});var W=d(()=>{document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("modal"),o=document.getElementsByClassName("modal-close"),n=document.getElementsByClassName("modal-open");Array.from(o).forEach(s=>{s.addEventListener("click",()=>{e.classList.add("hidden"),e.classList.remove("flex")})}),Array.from(n).forEach(s=>{s.addEventListener("click",()=>{e.classList.add("flex"),e.classList.remove("hidden")})}),e.addEventListener("click",s=>{s.target===e&&(e.classList.add("hidden"),e.classList.remove("flex"))})})});var G=d(()=>{var{toast:N}=(p(),f(m));window.location.pathname==="/admin/users"&&document.addEventListener("DOMContentLoaded",function(){let e=document.getElementsByClassName("delete-user-btn");Array.from(e).forEach(o=>{o.addEventListener("click",n=>{n.stopPropagation();let s=o.getAttribute("data-user-id");ce(s)})})});async function ce(e){try{if((await fetch(`/common/v1/users/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).ok){let n=document.querySelector(`#user-${e}`);n.classList.add("border-rose-500"),n.remove(),N("User deleted.","success")}else N("Deletion failed.","error")}catch{N("Something went wrong.","error")}}});j();I();M();U();F();$();J();R();H();_();Y();W();p();G();})();
